---
sidebar_position: 1
---

# 브라우저 주소창에 `www.google.com`을 입력하면 어떤 일이 일어나는가?

주소창에 `www.google.com`을 치고 Enter를 눌렀을 때 아래 그림처럼 총 3단계로 구분할 수 있다.

![브라우저 렌더링 과정](./svg/브라우저%20렌더링%20과정.svg)

## 브라우저 렌더링 과정

### 1. 주소창에 입력한 텍스트 정보 확인

- 대부분의 인터넷 브라우저는 자사의 주소창과 검색창을 동일하게 사용하고 있다.(대표적으로 Chrome은 주소창을 구굴의 검색창으로 쓰고 있다.)
- 이럴 경우 브라우저는 사용자가 주소창에 어떤 텍스트를 입력했을 때, 이 텍스트가 검색어인지 URL인지 우선적으로 확인한다.(이 작업의 주체는 브라우저 엔진의 UI 스레드이다.)

1.  입력한 텍스트가 검색어라면,

    -> 브라우저는 검색 엔진의 URL에 검색어를 포함한 주소로 페이지를 이동시킨다.

2.  입력한 텍스트가 URL이면,

    -> 브라우저 엔진에서 (네트워크 스레드를 통해)네트워크 호출을 수행한다.

- 따라서, 주소창에 `www.google.com`을 입력한 경우 브라우저는 네트워크 호출을 수행하게 된다.

<br></br>

### 2. 네트워크 호출

- 먼저 브라우저가 왜 네트워크 호출을 수행해야 하는가?

  - 브라우저가 사용자에게 '구글'이라는 사이트를 화면에 보여주기 위해서 구글의 HTMl, CSS, 스크립트, 이미지 등의 데이터를 미리 가지고 있어야 한다. 하지만 현재 브라우저는 이러한 정보가 없고, 이러한 데이터들은 구글 서버 컴퓨터에 있다.
  - 때문에 브라우저는 구글 서버와의 네트워크 통신을 통해 이러한 데이터를 가져와야 한다. 따라서 '네트워크 호출' 과정은 크게 아래의 두 가지 과정으로 나누어 볼 수 있다.

1. 구글 서버의 주소를 알기 위해 네임 서버(`Name Server`)와 통신하기

2. 알아낸 주소를 바탕으로 구글 서버와 통신하여 필요한 데이터 응답받기

#### 1. 구글 서버의 주소를 찾는 과정

- 구글 서버의 주소를 알아내기 위해 **클라이언트**(사용자의 컴퓨터)는 다음 과정을 수행한다.

  1. 자신의 host 파일에서 **도메인 네임**(`google.com`)에 대응하는 IP 주소가 있는지 우선적으로 확인한다.

  2. 만일 없다면, 네임 서버(`Name Server`)에 '구글의 IP 주소를 알려주세요.'라는 요청을 보낸다.

- 인터넷은 컴퓨터의 주소인 IP 주소를 기반으로 동작한다. 하지만 우리가 인터넷을 사용할 땐, IP 주소 대신 사용하기 쉽도록 문자로 이루어진 도메인 네임을 사용한다.

- 따라서 도메인 네임을 IP 주소로 변환해 주는 환경인 **DNS**(**`Domain Name Server`**)가 반드시 필요한데, 이 DNS를 운영하는 장치를 **네임 서버**(**`Name Server`**) 혹은 DNS 서버라 한다.

#### 2. 구글 서버와 통신하여 필요한 데이터를 받는 과정

- 이제 클라이언트는 구글 서버의 IP 주소를 알게 되어 구글 서버와 통신할 수 있게 되었다. 클라이언트의 브라우저는 (TCP 소켓을 열고 이를 통해) 구글 서버에 데이터를 요청하는 `HTTP Request`를 보낸다.

- `HTTP Request`를 받은 구글 서버는 클라이언트가 요청한 문서를 찾아 읽고 이를 바이트 형태로 변환한 후, 클라이언트로 **`HTTP Reply`**(**`HTTP Response`**)를 보낸다.

![서버와 통신하여 필요한 데이터를 받는 과정](./svg/서버와%20통신하여%20필요한%20데이터를%20받는%20과정.svg)

### 3. 렌더링 작업

- 브라우저 엔진(의 네트워크 스레드)은 네이버 서버로부터 응답받은 데이터에 악성 바이러스가 있는지 우선 검사한다. 이 데이터는 바이트 형태의 텍스트 문서이므로, 브라우저 엔진이 읽을 수 없다. 따라서 브라우저 엔진(의 UI 스레드)은 **렌더링 엔진**에게 해당 데이터를 해석하고, 웹 페이지를 화면에 띄울 것을 요청한다.

- 요청을 받은 렌더링 엔진은 받은 데이터를 바탕으로 **렌더링 프로세스**를 수행하고, 이 과정이 끝나면 브라우저 엔진에게 작업 완료를 알린다.

<br></br>

## 렌더링 프로세스

- 렌더링 엔진은 브라우저 엔진으로부터 요청받은 내용을 화면에 표시해주는 역할을 한다.

![렌더링 프로세스](./svg/렌더링%20프로세스.svg)

- 렌더링 과정은 아래 4가지 과정으로 이루어진다.

  1. HTML을 파싱하여 **DOM 트리 구축**, CSS를 파싱하여 **CSSOM 트리 구출** (+ JS 파싱)

  2. DOM 트리와 CSSOM 트리를 통해 렌더 트리 구축

  3. 렌더 트리 **배치**(Layout, Reflow)

  4. 렌더 트리 **그리기**(Paint)

### 파싱이란?

렌더링 프로세스를 이해하기 전에 파싱에 대해 이해해야 한다.

- 브라우저는 HTML, CSS 등 단순한 텍스트 문서를 이해하지 못한다. 따라서 이 문서를 브라우저가 이해할 수 있는 구조로 변화해주는 과정이 반드시 피요하다. 이를 **파싱**(**Parsing**)이라 한다.

- 파싱은 '어휘 분석'과 '구문 분석' 두 가지 과정으로 구분할 수 있다.

  1. **어휘 분석**: 문자열을 의미있는 작은 단위인 **토큰**(**token**)으로 분해하는 과정

  2. **구문 분석**: 문자열의 문법에 따라 토큰 간의 위계관계를 분석하여 **Parsing 트리**를 생성하는 과정

     :::note 파싱 예시
     HTML 문서 `<div>Hello World</div>`를 파싱하는 과정:

     1. **어휘 분석**: `<div>`, `Hello World`, `</div>` 토큰으로 + 분해
     2. **구문 분석**: div 태그 안에 텍스트가 있는 구조로 + 분석하여 트리 생성
        :::
        :::note 파싱 결과 생성되는 트리 형태를 parse 트리, parsing 트리, concrete syntax 트리 등 다양한 용어로 불린다.
        :::
        :::note parse 트리는 토큰화된 문자열의 단순한 트리에 불과하므로, 이를 바로 사용할 순 없다. 따라서 브라우저는 이 parse 트리를 DOM 트리로 바꾸어 사용한다.
        :::

#### 1.1 HTML 파싱 -> DOM 트리 파싱
